# requestAnimationFrame

rAF用于在下次重绘之前调用指定函数更新动画。

通常每秒触发60次，即60FPS。而当页签处于后台时，浏览器会自动降低触发频率或暂停

## 核心价值
1. 保障流畅性：避免使用setTimeout/setInterval导致的丢帧或卡顿

2. 性能优化：减少不必要的DOM操作和布局计算，与css动画搭配触发GPU加速

3. 节能性：后台页签自动暂停或降低回调函数频率

## 常见误区

1. 非动画滥用：避免在非视觉更新场景（数据计算）使用rAF，可能延迟执行

2. 过度递归：未设置终止条件的递归调用会导致内存泄漏

3. 忽略布局成本：在rAF回调中频繁读取布局属性（offsetWidth），触发强制同步布局

#### 强制同步布局（FSL）

当js代码在修改DOM或样式后，立即读取布局属性，浏览器会强制立即执行布局阶段

**正常的渲染流程：**

1. js执行：修改DOM或样式
2. 布局：浏览器在js执行完成后，统一计算所有元素的几何属性
3. 绘制：将布局结果转换为像素
4. 合成：合成图层，生成最终图像

**触发FSL的渲染流程：**

1. js执行：修改DOM或样式
2. 触发FSL：强制同步布局
3. 继续执行js代码
4. 触发FSL：强制同步布局
5. 继续执行js代码
6. 布局：计算新样式
7. 绘制
8. 合成